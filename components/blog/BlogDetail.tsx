// const BlogDetail = () => {
//   return (
//     <div>
//       <div className="clip-group-section">
//         <div>
//           <div className="base-container-5">
//             <div
//               id="w-node-b1de9f25-40d3-d506-90f0-64454d955ac8-fbbea1d7"
//               className="blog-template-wrap banner"
//             >
//               <div className="content-blog-details-wrap">
//                 <div
//                   id="w-node-b1de9f25-40d3-d506-90f0-64454d955aca-fbbea1d7"
//                   className="blog-intro-content-2"
//                 >
//                   <div className="title-blog-container">
//                     <div
//                       data-w-id="b1de9f25-40d3-d506-90f0-64454d955acc"
//                       className="date-wrap"
//                     >
//                       <a
//                         href="/posts-categories/guides"
//                         className="carsy-blog-category"
//                       >
//                         Guides
//                       </a>
//                       <div className="date-line-container">
//                         <div className="date-line"></div>
//                       </div>
//                       <div className="subtitle-data">July 14, 2024</div>
//                     </div>
//                     <h1
//                       data-w-id="b1de9f25-40d3-d506-90f0-64454d955ad3"
//                       className="blog-details-title"
//                     >
//                       Benefits of Regular Oil Changes: Why It's Essential
//                     </h1>
//                     <p
//                       data-w-id="b1de9f25-40d3-d506-90f0-64454d955ad5"
//                       className="banner-paragraph"
//                     >
//                       Maintaining your car in peak condition is crucial for its
//                       longevity and performance. At Carsy, we believe in
//                       offering top-notch services that cater to every aspect of
//                       your vehicle's needs. Our comprehensive car services
//                       ensure that your car remains safe, reliable, and
//                       efficient.
//                     </p>
//                   </div>
//                 </div>
//                 <div
//                   id="w-node-b1de9f25-40d3-d506-90f0-64454d955ad7-fbbea1d7"
//                   className="scroll-blog-link"
//                 >
//                   <div
//                     data-w-id="b1de9f25-40d3-d506-90f0-64454d955ad8"
//                     className="circle-link-wrapper"
//                   >
//                     <a
//                       href="#Blog-Content"
//                       className="scroll-blog-circle-2 w-inline-block"
//                     >
//                       <div className="link-hover-fill-2"></div>
//                       <img
//                         loading="lazy"
//                         src="https://cdn.prod.website-files.com/669e1212d181ce4bfbbea175/66ab3d5fbf81bfba50d9bbd5_arrow-right(48x48)%402x.svg"
//                         alt="Png"
//                         className="blog-arrow-2"
//                       />
//                     </a>
//                   </div>
//                 </div>
//               </div>
//             </div>
//           </div>
//         </div>
//         <div
//           data-w-id="b1de9f25-40d3-d506-90f0-64454d955adc"
//           className="section-blog-details"
//         >
//           <div
//             data-w-id="b1de9f25-40d3-d506-90f0-64454d955add"
//             className="background-blog-wrapper-2"
//           >
//             <div
//               data-w-id="b1de9f25-40d3-d506-90f0-64454d955ade"
//               style={{
//                 backgroundImage: `url("https://cdn.prod.website-files.com/669e1212d181ce4bfbbea18b/66a0eb12acfdc13c06e12f85_Blog-1.jpg")`,
//                 WebkitTransform:
//                   "translate3d(0, 0, 0) scale3d(1.3, 1.3, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0)",
//                 MozTransform:
//                   "translate3d(0, 0, 0) scale3d(1.3, 1.3, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0)",
//                 msTransform:
//                   "translate3d(0, 0, 0) scale3d(1.3, 1.3, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0)",
//                 transform:
//                   "translate3d(0, 0, 0) scale3d(1.3, 1.3, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0)",
//               }}
//               className="blog-details-background-image"
//             >
//               <div className="news-detail-overlay"></div>
//             </div>
//           </div>
//         </div>
//         <div id="Blog-Content" className="section-gray">
//           <div className="soft-black-bg">
//             <div className="base-container">
//               <div className="blog-template-wrap">
//                 <div className="hero-rich-text-style w-richtext">
//                   <h2>The Ultimate Guide to Car Service</h2>
//                   <p>
//                     Welcome to Carsy's comprehensive blog on car service.
//                     Whether you're a seasoned car owner or a new driver,
//                     understanding the ins and outs of car service is crucial for
//                     maintaining your vehicle's performance and extending its
//                     lifespan. In this detailed guide, we will cover various
//                     aspects of car service, from routine maintenance to advanced
//                     diagnostics, providing you with the knowledge to keep your
//                     car in top condition.
//                   </p>
//                   <p>
//                     Cars are more than just a mode of transportation; they are
//                     marvels of engineering and symbols of freedom and
//                     innovation. At Carsy, we not only provide top-notch service
//                     and repair but also celebrate the intricate world of
//                     automobiles. Here are some fascinating facts about cars,
//                     repair, and service that every car enthusiast should know.
//                   </p>
//                   <h3>
//                     <strong>The Evolution of Cars</strong>
//                   </h3>
//                   <p>
//                     The first gasoline-powered car was created by Karl Benz in
//                     1885. This three-wheeled vehicle, known as the Benz
//                     Patent-Motorwagen, was the beginning of a revolution in
//                     transportation. Today, cars have evolved into sophisticated
//                     machines equipped with advanced technologies such as
//                     self-driving capabilities, electric powertrains, and
//                     connectivity features.
//                   </p>
//                   <p>
//                     The internal combustion engine (ICE) has been the heart of
//                     automobiles for over a century. However, with growing
//                     environmental concerns, there has been a significant shift
//                     towards electric vehicles (EVs). The first electric car was
//                     built in the early 19th century, but it wasn't until Tesla
//                     Motors introduced the Roadster in 2008 that EVs gained
//                     mainstream popularity. Today, many car manufacturers are
//                     committed to phasing out ICEs in favor of EVs.
//                   </p>
//                   <h3>
//                     <strong>The Science of Tires</strong>
//                   </h3>
//                   <p>
//                     Tires are often overlooked, but they play a crucial role in
//                     vehicle performance and safety. Did you know that tire
//                     pressure can affect fuel efficiency? Under-inflated tires
//                     can decrease fuel economy by up to 0.2% for every 1 psi drop
//                     in the average pressure. Additionally, the tread pattern and
//                     rubber compound used in tires are designed to provide
//                     optimal grip in various weather conditions, ensuring safety
//                     and performance.
//                   </p>
//                   <h5>
//                     <strong>Interesting Car Repair Facts</strong>
//                   </h5>
//                   <ul role="list">
//                     <li>
//                       <strong>Windshield Repairs:</strong>
//                       Did you know that small chips or cracks in your windshield
//                       can often be repaired without replacing the entire
//                       windshield? Special resins are injected into the damaged
//                       area, restoring the structural integrity and clarity of
//                       the glass.
//                     </li>
//                     <li>
//                       <strong>Battery Recycling:</strong>
//                       Car batteries are one of the most recycled products in the
//                       world. More than 99% of lead-acid batteries are recycled,
//                       helping to reduce environmental impact and conserve
//                       resources.
//                     </li>
//                     <li>
//                       <strong>Brake Pad Materials:</strong>
//                       Brake pads can be made from various materials, including
//                       organic, ceramic, and metallic compounds. Each type has
//                       its own advantages in terms of performance, noise, and
//                       longevity.
//                     </li>
//                     <li>
//                       <strong>Engine Light:</strong>A glowing check engine light
//                       can indicate a range of issues, from a loose gas cap to a
//                       faulty oxygen sensor. Ignoring it can lead to more serious
//                       problems, so it's important to have it checked as soon as
//                       possible.
//                     </li>
//                     <li>
//                       <strong>Transmission Fluids:</strong>
//                       Different cars require different types of transmission
//                       fluids. Using the wrong type can cause shifting problems
//                       and damage the transmission. Always consult your owner's
//                       manual or a professional mechanic.
//                     </li>
//                   </ul>
//                   <p>
//                     Modern cars are equipped with complex computer systems that
//                     monitor and control various functions. On-board diagnostics
//                     (OBD) systems can detect issues before they become major
//                     problems. The OBD-II standard, introduced in the mid-1990s,
//                     allows mechanics to use diagnostic scanners to retrieve
//                     trouble codes from the car's computer, making it easier to
//                     identify and fix issues. This technology has revolutionized
//                     car repair and maintenance.
//                   </p>
//                   <figure
//                     style={{ maxWidth: "1920pxpx" }}
//                     className="w-richtext-align-fullwidth w-richtext-figure-type-image"
//                   >
//                     <div>
//                       <img
//                         src="https://cdn.prod.website-files.com/669e1212d181ce4bfbbea18b/66ab45ece450fc3145aa69f9_66a0ad03ec4ec71580a633e6_Services-7.jpeg"
//                         loading="lazy"
//                         alt=""
//                       />
//                     </div>
//                   </figure>
//                   <h3>
//                     <strong>The Importance of Regular Maintenance</strong>
//                   </h3>
//                   <p>
//                     Regular maintenance is essential to keep your car running
//                     smoothly and prolong its lifespan. Simple tasks such as oil
//                     changes, brake inspections, and tire rotations can prevent
//                     major issues down the line. For instance, changing your oil
//                     at regular intervals prevents engine wear and keeps it
//                     running efficiently. Similarly, regular brake inspections
//                     ensure your safety by maintaining optimal braking
//                     performance.
//                   </p>
//                   <p>
//                     While many car owners enjoy the satisfaction of
//                     do-it-yourself (DIY) repairs, there are certain tasks that
//                     are best left to professionals. Complex repairs, such as
//                     transmission rebuilds or advanced electrical work, require
//                     specialized tools and expertise. At Carsy, our certified
//                     technicians are trained to handle all types of repairs,
//                     ensuring your car receives the best possible care.
//                   </p>
//                   <h4>
//                     <strong>The Evolution of Automobiles</strong>
//                   </h4>
//                   <p>
//                     The history of cars dates back to the late 19th century.
//                     Karl Benz is credited with creating the first
//                     gasoline-powered automobile, the Benz Patent-Motorwagen, in
//                     1885. This three-wheeled vehicle marked the beginning of a
//                     transportation revolution. Over the years, cars have evolved
//                     from simple, mechanically-driven machines to sophisticated,
//                     tech-savvy vehicles.
//                   </p>
//                   <blockquote>
//                     "Owning a car is a relationship built on trust and care.
//                     Regular maintenance and attention to detail ensure that your
//                     vehicle remains a faithful and reliable partner on all your
//                     adventures."
//                   </blockquote>
//                   <p>
//                     Regular maintenance is essential to keep your car running
//                     smoothly and prolong its lifespan. Simple tasks such as oil
//                     changes, brake inspections, and tire rotations can prevent
//                     major issues down the line. For instance, changing your oil
//                     at regular intervals prevents engine wear and keeps it
//                     running efficiently. Similarly, regular brake inspections
//                     ensure your safety by maintaining optimal braking
//                     performance.
//                   </p>
//                   <p>
//                     While many car owners enjoy the satisfaction of
//                     do-it-yourself (DIY) repairs, there are certain tasks that
//                     are best left to professionals. Complex repairs, such as
//                     transmission rebuilds or advanced electrical work, require
//                     specialized tools and expertise. At Carsy, our certified
//                     technicians are trained to handle all types of repairs,
//                     ensuring your car receives the best possible care.
//                   </p>
//                   <h3>
//                     <strong>The Future of Car Service</strong>
//                   </h3>
//                   <p>
//                     The automotive service industry is rapidly evolving with the
//                     advent of new technologies. Augmented reality (AR) is being
//                     used to assist mechanics in diagnosing and repairing
//                     vehicles. With AR glasses, technicians can access real-time
//                     information and 3D overlays of vehicle components, making
//                     repairs more efficient and accurate. Additionally,
//                     predictive maintenance, powered by artificial intelligence
//                     (AI), uses data from connected cars to anticipate and
//                     prevent issues before they occur.
//                   </p>
//                   <p>
//                     Carsy is committed to providing exceptional car service and
//                     repair while sharing our passion for automobiles with our
//                     customers. Understanding the fascinating world of cars helps
//                     you appreciate the intricate systems that keep your vehicle
//                     running smoothly. Whether you're curious about the latest
//                     innovations or seeking expert repair services, Carsy is your
//                     trusted partner on the road.
//                   </p>
//                 </div>
//                 <div
//                   data-w-id="b1de9f25-40d3-d506-90f0-64454d955b4f"
//                   className="blog-template-pagination-2"
//                 >
//                   <div className="slider-blog-arrow">
//                     <a
//                       href="/blog-posts/how-to-choose-the-right-tires-for-your-vehicle"
//                       className="blog-link-pagination w-inline-block"
//                     >
//                       <img
//                         loading="lazy"
//                         src="https://cdn.prod.website-files.com/669e1212d181ce4bfbbea175/669fcff153cd4bffc62cb773_Arrow%20White%20L.svg"
//                         alt="Project photo"
//                         className="previ-post-arrow"
//                       />
//                       <div className="blog-template-next-2 left">
//                         <div className="clip">
//                           <div className="btn-banner-text">
//                             <h6 className="top-text-blog">Previous post</h6>
//                           </div>
//                           <div className="btn-banner-text button-text-bottom">
//                             <h6 className="top-text-blog">Previous post</h6>
//                           </div>
//                         </div>
//                         <h6 className="blog-details-link">
//                           How to Choose the Right Tires for Your Vehicle
//                         </h6>
//                       </div>
//                     </a>
//                   </div>
//                   <div className="slider-blog-arrow right">
//                     <a
//                       href="/blog-posts/diy-car-care-simple-fixes-you-can-do-at-home"
//                       className="blog-link-pagination w-inline-block"
//                     >
//                       <div className="blog-template-next-2">
//                         <div className="clip">
//                           <div className="btn-banner-text">
//                             <h6 className="top-text-blog">Next post</h6>
//                           </div>
//                           <div className="btn-banner-text button-text-bottom">
//                             <h6 className="top-text-blog">Next post</h6>
//                           </div>
//                         </div>
//                         <h6 className="blog-details-link">
//                           DIY Car Care: Simple Fixes You Can Do at Home
//                         </h6>
//                       </div>
//                       <img
//                         loading="lazy"
//                         src="https://cdn.prod.website-files.com/669e1212d181ce4bfbbea175/669fcff281897ab23a323451_Arrow%20White.svg"
//                         alt="Project photo"
//                         className="next-post-arrow-icon"
//                       />
//                     </a>
//                   </div>
//                 </div>
//               </div>
//             </div>
//           </div>
//         </div>
//       </div>
//     </div>
//   );
// };

// export default BlogDetail;






"use client";

import { useState, useEffect } from "react";
import { fetchBlogPostBySlug, getImageUrl } from "@/lib/fetchBlogPosts";

interface BlogDetailProps {
  params: { slug: string } | Promise<{ slug: string }>;
}

export default function BlogDetail({ params }: BlogDetailProps) {
  const [data, setData] = useState<any>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [slug, setSlug] = useState<string | null>(null);

  useEffect(() => {
    const loadData = async () => {
      try {
        console.log("=== BLOG DETAIL DEBUG ===");
        console.log("Raw params:", params);

        let resolvedParams: { slug: string };

        if (params instanceof Promise) {
          resolvedParams = await params;
        } else {
          resolvedParams = params;
        }

        console.log("Resolved params:", resolvedParams);

        if (!resolvedParams || !resolvedParams.slug) {
          setError("Invalid URL - no slug provided");
          setLoading(false);
          return;
        }

        const slugValue = resolvedParams.slug;
        setSlug(slugValue);

        const fetchedData = await fetchBlogPostBySlug(slugValue);

        if (fetchedData) {
          setData(fetchedData);
          setError(null);
        } else {
          setError(`Blog post with slug "${slugValue}" not found`);
        }
      } catch (err) {
        console.error("Error loading blog post:", err);
        setError("Failed to load blog post");
      } finally {
        setLoading(false);
      }
    };

    loadData();
  }, [params]);

  if (loading) {
    return (
      <div className="base-container py-20 text-center">
        <p>Loading blog post...</p>
      </div>
    );
  }

  if (error || !data) {
    return (
      <div className="base-container py-20 text-center">
        <h1 className="text-4xl font-bold mb-4">Blog Post Not Found</h1>
        <p className="mb-4">{error}</p>
        <a href="/blog" className="text-blue-600 hover:underline">
          Back to Blog
        </a>
      </div>
    );
  }

  const {
    heroSection = {},
    backgroundImageSection = {},
    contentSection = {},
    paginationSection = {},
    sectionOrder = [],
  } = data;

  const getBackgroundImage = () => {
    const bg = backgroundImageSection.backgroundImage;
    if (!bg) return bg?.imageUrl || "";

    const width = typeof window !== "undefined" ? window.innerWidth : 1920;
    if (width <= 420 && bg.mobile?.url) return getImageUrl(bg.mobile);
    if (width <= 800 && bg.tablet?.url) return getImageUrl(bg.tablet);
    if (width <= 1400 && bg.desktop?.url) return getImageUrl(bg.desktop);
    return (
      getImageUrl(bg.large) || getImageUrl(bg.desktop) || bg.imageUrl || ""
    );
  };

  const renderSections = () => {
    if (!sectionOrder || sectionOrder.length === 0) {
      return (
        <>
          {renderHero()}
          {renderBackgroundImage()}
          {renderContent()}
          {renderPagination()}
        </>
      );
    }

    return sectionOrder.map((item: { section: string }) => {
      switch (item.section) {
        case "hero":
          return renderHero();
        case "backgroundImage":
          return renderBackgroundImage();
        case "content":
          return renderContent();
        case "pagination":
          return renderPagination();
        default:
          return null;
      }
    });
  };

  const renderHero = () => {
    if (!heroSection.show) return null;

    return (
      <div
        key="hero"
        className={heroSection.containerClassName || "base-container-5"}
      >
        <div className={heroSection.className || "blog-template-wrap banner"}>
          <div className="content-blog-details-wrap">
            <div className="blog-intro-content-2">
              <div className="title-blog-container">
                {heroSection.categoryTag?.show && (
                  <div
                    data-w-id="b1de9f25-40d3-d506-90f0-64454d955acc"
                    className="date-wrap"
                  >
                    <a
                      href={heroSection.categoryTag.url || "#"}
                      className={
                        heroSection.categoryTag.className ||
                        "carsy-blog-category"
                      }
                    >
                      {heroSection.categoryTag.label}
                    </a>
                    {heroSection.dateDisplay?.showDivider && (
                      <div className="date-line-container">
                        <div className="date-line"></div>
                      </div>
                    )}
                    {heroSection.dateDisplay?.show && (
                      <div
                        className={
                          heroSection.dateDisplay.className || "subtitle-data"
                        }
                      >
                        {heroSection.dateDisplay.date}
                      </div>
                    )}
                  </div>
                )}
                <h1
                  data-w-id="b1de9f25-40d3-d506-90f0-64454d955ad3"
                  className={heroSection.titleClassName || "blog-details-title"}
                >
                  {heroSection.title}
                </h1>
                <p
                  data-w-id="b1de9f25-40d3-d506-90f0-64454d955ad5"
                  className={heroSection.introClassName || "banner-paragraph"}
                >
                  {heroSection.introText}
                </p>
              </div>
            </div>
            {heroSection.scrollLink?.show && (
              <div className="scroll-blog-link">
                <div
                  data-w-id="b1de9f25-40d3-d506-90f0-64454d955ad8"
                  className="circle-link-wrapper"
                >
                  <a
                    href={heroSection.scrollLink.targetId || "#Blog-Content"}
                    className="scroll-blog-circle-2 w-inline-block"
                  >
                    <div className="link-hover-fill-2"></div>
                    <img
                      loading="lazy"
                      src={
                        getImageUrl(heroSection.scrollLink.arrowIcon) ||
                        heroSection.scrollLink.arrowIconUrl
                      }
                      alt="Scroll down"
                      className="blog-arrow-2"
                    />
                  </a>
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    );
  };

  const renderBackgroundImage = () => {
    if (!backgroundImageSection.show) return null;

    return (
      <div
        key="backgroundImage"
        data-w-id="b1de9f25-40d3-d506-90f0-64454d955adc"
        className={backgroundImageSection.className || "section-blog-details"}
      >
        <div
          data-w-id="b1de9f25-40d3-d506-90f0-64454d955add"
          className="background-blog-wrapper-2"
        >
          <div
            data-w-id="b1de9f25-40d3-d506-90f0-64454d955ade"
            style={{
              backgroundImage: `url("${getBackgroundImage()}")`,
              WebkitTransform: `translate3d(0, 0, 0) scale3d(${
                backgroundImageSection.imageScale || 1.3
              }, ${
                backgroundImageSection.imageScale || 1.3
              }, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0)`,
              transform: `translate3d(0, 0, 0) scale3d(${
                backgroundImageSection.imageScale || 1.3
              }, ${
                backgroundImageSection.imageScale || 1.3
              }, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0)`,
            }}
            className="blog-details-background-image"
          >
            {backgroundImageSection.overlay?.show && (
              <div
                className={
                  backgroundImageSection.overlay.overlayClassName ||
                  "news-detail-overlay"
                }
              ></div>
            )}
          </div>
        </div>
      </div>
    );
  };

  const renderContent = () => {
    if (!contentSection.show) return null;

    return (
      <div
        key="content"
        id={contentSection.sectionId || "Blog-Content"}
        className={contentSection.className || "section-gray"}
      >
        <div className="soft-black-bg">
          <div
            className={contentSection.containerClassName || "base-container"}
          >
            <div
              className={contentSection.wrapClassName || "blog-template-wrap"}
            >
              <div
                className={
                  contentSection.richTextClassName ||
                  "hero-rich-text-style w-richtext"
                }
                dangerouslySetInnerHTML={{
                  __html: contentSection.content || "",
                }}
              />
            </div>
          </div>
        </div>
      </div>
    );
  };

  const renderPagination = () => {
    if (!paginationSection.show) return null;

    return (
      <div
        key="pagination"
        data-w-id="b1de9f25-40d3-d506-90f0-64454d955b4f"
        // className={paginationSection.className || "blog-template-pagination-2"}
      >
        {/* {paginationSection.previousPost?.show && (
          <div className="slider-blog-arrow">
            <a
              href={paginationSection.previousPost.url}
              className="blog-link-pagination w-inline-block"
            >
              <img
                loading="lazy"
                src={
                  getImageUrl(paginationSection.previousPost.arrowIcon) ||
                  paginationSection.previousPost.arrowIconUrl
                }
                alt="Previous"
                className="previ-post-arrow"
              />
              <div className="blog-template-next-2 left">
                <div className="clip">
                  <div className="btn-banner-text">
                    <h6 className="top-text-blog">
                      {paginationSection.previousPost.label}
                    </h6>
                  </div>
                  <div className="btn-banner-text button-text-bottom">
                    <h6 className="top-text-blog">
                      {paginationSection.previousPost.label}
                    </h6>
                  </div>
                </div>
                <h6 className="blog-details-link">
                  {paginationSection.previousPost.title}
                </h6>
              </div>
            </a>
          </div>
        )}

        {paginationSection.nextPost?.show && (
          <div className="slider-blog-arrow right">
            <a
              href={paginationSection.nextPost.url}
              className="blog-link-pagination w-inline-block"
            >
              <div className="blog-template-next-2">
                <div className="clip">
                  <div className="btn-banner-text">
                    <h6 className="top-text-blog">
                      {paginationSection.nextPost.label}
                    </h6>
                  </div>
                  <div className="btn-banner-text button-text-bottom">
                    <h6 className="top-text-blog">
                      {paginationSection.nextPost.label}
                    </h6>
                  </div>
                </div>
                <h6 className="blog-details-link">
                  {paginationSection.nextPost.title}
                </h6>
              </div>
              <img
                loading="lazy"
                src={
                  getImageUrl(paginationSection.nextPost.arrowIcon) ||
                  paginationSection.nextPost.arrowIconUrl
                }
                alt="Next"
                className="next-post-arrow-icon"
              />
            </a>
          </div>
        )} */}
      </div>
    );
  };

  return (
    <div className="clip-group-section">
      <div>{renderSections()}</div>
    </div>
  );
}